SELECT *
FROM tests.promotions
WHERE "retailerId" IN (1, 2, 3, 9, 11, 8, 10)
  AND "coreProductId" &&
      ARRAY [1754, 4064, 4298, 4299, 4300, 4304, 4331, 4364, 4372, 4373, 4377, 4483, 4572, 4657,
          4691, 5015, 11317, 11564, 11566, 11579, 14398, 16546, 16547, 16548, 16936, 19032,
          20084, 20581, 20598, 21753, 21806, 22836, 24269, 24923, 26148, 26155, 26349, 37606,
          38006, 42148, 42763, 43008, 44825, 45525, 45750, 45912, 48006, 52635, 62359, 62361,
          63173, 63192, 64020, 69967, 82042, 82046, 120284, 120336, 240260, 240264, 277565, 311911,
          317558, 317560, 317562, 364807, 364818, 442818, 486859, 496581, 541845, 541846, 542649,
          543683, 547213, 547214, 561431, 561432, 566211, 641051, 729377, 729379, 731701, 737617,
          737618, 737619, 739687, 739689, 739703, 739705, 739709, 765926, 780436, 781601, 784964,
          784965, 790677, 793114, 849813, 863968, 879772, 879773]
  AND DATERANGE("startDate", "endDate") && DATERANGE('2023-11-01', '2023-11-15');

--Galbani Italian Mozzarella Cheese 225g
--morrisons
/*
 2023-11-13

 Base Price
£ 1.85
01 Nov 2023
£ 1.85
15 Nov 2023
0.00%
Change
Shelf Price
£ 1.85
01 Nov 2023
£ 1.25
15 Nov 2023
-32.43%
deriction
Change
Promoted Price
£ 0.60
Average Discount
-32.43%
deriction
Average change
 */

WITH response AS (SELECT *--JSON_AGG(promotions ORDER BY "startDate")
                  FROM tests.promotions
                  WHERE "retailerId" IN (1, 2, 3, 9, 11, 8, 10) --  AND "product"."retailerId" IN ('81', '1', '2', '3', '9', '11', '8', '10');
                    --  WHAT about "retailerId" IN '01', '1'?
                    AND "coreProductId" &&
                        ARRAY [1754, 4064, 4298, 4299, 4300, 4304, 4331, 4364, 4372, 4373, 4377, 4483, 4572, 4657,
                            4691, 5015, 11317, 11564, 11566, 11579, 14398, 16546, 16547, 16548, 16936, 19032,
                            20084, 20581, 20598, 21753, 21806, 22836, 24269, 24923, 26148, 26155, 26349, 37606,
                            38006, 42148, 42763, 43008, 44825, 45525, 45750, 45912, 48006, 52635, 62359, 62361,
                            63173, 63192, 64020, 69967, 82042, 82046, 120284, 120336, 240260, 240264, 277565, 311911,
                            317558, 317560, 317562, 364807, 364818, 442818, 486859, 496581, 541845, 541846, 542649,
                            543683, 547213, 547214, 561431, 561432, 566211, 641051, 729377, 729379, 731701, 737617,
                            737618, 737619, 739687, 739689, 739703, 739705, 739709, 765926, 780436, 781601, 784964,
                            784965, 790677, 793114, 849813, 863968, 879772, 879773]
                    AND DATERANGE("startDate", "endDate") && DATERANGE('2023-11-01', '2023-11-15'))
select *
from response